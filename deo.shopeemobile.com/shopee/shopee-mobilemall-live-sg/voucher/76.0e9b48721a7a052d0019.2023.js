"use strict";(globalThis.webpackChunk_shopee_voucher_rw=globalThis.webpackChunk_shopee_voucher_rw||[]).push([[76],{1291:(e,o,r)=>{r.d(o,{CH:()=>c,fq:()=>p,x2:()=>h});var s=r(1966);function h(e,o){let r=[];if(e?.recommendedShopVouchers?.shopData&&o.length>0){r=o.map(o=>({shopid:o,shopName:e.recommendedShopVouchers.shopData?.[o]?e.recommendedShopVouchers.shopData[o].shopName:"",shopType:e.recommendedShopVouchers.shopData?.[o]?e.recommendedShopVouchers.shopData[o].shopType:s.l.NORMAL,vouchers:e.recommendedShopVouchers.shopData?.[o]?e.recommendedShopVouchers.shopData[o].vouchers:[]}),[]);let h=e.recommendedShopVouchers.shopDataPositionMap||{};Object.keys(h).length>0&&r.sort((e,o)=>(h[e.shopid]??Number.MAX_SAFE_INTEGER)-(h[o.shopid]??Number.MAX_SAFE_INTEGER))}return r.length>0?r.filter(e=>e.vouchers.length>0):r}function c(e){return e?.recommendedShopVouchers?.next_cursor}function p(e,o,r){if(!r)return{};let s=e?.voucherDetail?.[o||"0"];return s?.[r]||{}}},8076:(e,o,r)=>{r.d(o,{z:()=>_});var s=r(2796),h=r(1594),c=r.n(h),p=r(9066),u=r(3276),d=r(1966),a=r(6983),m=r(8909),t=r(3501),n=r(1291);let{No:i}=m,l=(0,u.A)({[t.Us.REQUESTED]:(e,o)=>{let{shopId:r,itemId:s}=o,h=s?{[s]:{vouchers:e.shop?.[r]?.[s]?.vouchers||[],error:-100}}:{};return{...e,shop:{...e.shop,[r]:{...e.shop[r],...!s&&{error:-100}||{},...h}}}},[t.Us.SUCCESS]:(e,o)=>{let{data:r,shopId:s,itemId:h,priorityVoucherList:c}=o;return{...e,shop:{...e.shop,...!h&&{[s]:{error:0,vouchers:r?.voucher_list||[],priorityVoucherList:c}}||{},...h&&e.shop&&{[s]:{...e.shop[s],[h]:{vouchers:r?.voucher_list||[],error:0}}}}}},[t.Us.FAILED]:(e,o)=>{let{shopId:r,error:s,itemId:h}=o;return{...e,shop:{...e.shop,...!h&&{[r]:{error:s,vouchers:[]}}||{},error:s,...h&&e.shop&&{[r]:{...e.shop[r],[h]:{vouchers:[],error:s}}}}}},[t.zo.REQUESTED]:(e,o)=>({...e,recommendedShopVouchers:{...e.recommendedShopVouchers,progress:p.Ay.REQ},shop:{...e.shop,[o.shopId]:{vouchers:[],error:-100}}}),[t.zo.FAILED]:(e,o)=>({...e,recommendedShopVouchers:{...e.recommendedShopVouchers,progress:p.Ay.ERR,error:o.error,error_msg:o.error_msg},shop:{...e.shop,[o.shopId]:{...e.shop[o.shopId],error:o.error}}}),[t.zo.SUCCESS]:(e,o)=>{var r,s;let h,{data:c,shop_voucher_lists:u,shopId:m,isCheckout:t,next_cursor:n}=o;return{...e,recommendedShopVouchers:{...e.recommendedShopVouchers,...c?.shop_vouchers&&{[m]:(c.shop_vouchers||[]).filter(e=>!t&&![a.GM.NOT_COMPLETE_TASK].includes(e.invalid_message_code??-1/0)||!a.oV.includes(e.invalid_message_code??-1/0))},shopData:{...e.recommendedShopVouchers.shopData,...u.reduce((e,o)=>({...e,[o.shop_id??0]:{vouchers:(o.shop_vouchers||[]).filter(e=>!t&&![a.GM.NOT_COMPLETE_TASK].includes(e.invalid_message_code??-1/0)||!a.oV.includes(e.invalid_message_code??-1/0)),shopName:o.shop_name??"",shopType:o.shop_type??d.l.NORMAL}}),{})},shopDataPositionMap:{...e.recommendedShopVouchers.shopDataPositionMap,...(r=e.recommendedShopVouchers.shopDataPositionMap,s=u.map(e=>e.shop_id??0),h=Object.keys(r||{}).length,s.reduce((e,o,s)=>(r?.[o]!==void 0?e[o]=r[o]:e[o]=h+s,e),{}))},next_cursor:n,progress:p.Ay.OK},shop:{...e.shop,[m]:{...e.shop[m],error:0}}}},[i.FAILED]:(e,o)=>{let{payload:{error:r,error_msg:s,error_config:h,voucher_code:c}}=o;return{...e,claimProgress:{...e.claimProgress,[c]:{progress:r===a.Aq?p.Ay.OK:p.Ay.ERR,error:r,error_msg:s,error_config:h}}}},[i.SUCCESS]:(e,o)=>{let r=o.payload.voucher?.shop_id,{voucher_code:s,voucher_promotionid:h,voucher:c}=o.payload,u=e.shop,d=(0,n.fq)(e,s,h?String(h):null);if(r){let s=e.shop[r],h=(s?.vouchers||[]).map(e=>e.voucher_code===o.payload.voucher_code?{...e,is_claimed_before:!0}:e);u={...u,[r]:{...s,vouchers:[...h]}}}return{...e,shop:{...u},claimProgress:{...e.claimProgress,[o.payload.voucher_code]:{progress:p.Ay.OK}},voucherDetail:{[s||"0"]:{[h]:{...d,voucher_basic_info:d.voucher_basic_info||c?{...d.voucher_basic_info,...c}:null,progress:p.Ay.OK}}}}},[i.REQUESTED]:(e,o)=>({...e,claimProgress:{...e.claimProgress,[o.payload.voucher_code]:{progress:p.Ay.REQ}}}),[t.YZ.REQUESTED]:(e,o)=>({...e,claimProgress:{...e.claimProgress,[o.voucher_code]:{progress:p.Ay.REQ}}}),[t.YZ.SUCCESS]:(e,o)=>{let{voucher_code:r,invalid_message_code:s,shopid:h}=o,c=!s||s===a.cO.CLAIM_ERROR_EXIST,u=e.shop;if(h){let o=e.shop[h],s=(o?.vouchers||[]).map(e=>e.voucher_code===r?{...e,is_claimed_before:c}:e);u={...u,[h]:{...o,vouchers:[...s]}}}return{...e,shop:{...u},claimProgress:{...e.claimProgress,[r]:{progress:c?p.Ay.OK:p.Ay.ERR,invalid_message_code:s}}}},[t.YZ.FAILED]:(e,o)=>{let{error:r}=o;return{...e,claimProgress:{...e.claimProgress,[o.voucher_code]:{progress:r===a.Aq?p.Ay.OK:p.Ay.ERR,error:r,error_msg:o.error_msg}}}},[t.$m.REQUESTED]:(e,o)=>({...e,claimProgress:{...e.claimProgress,[o.voucher_code]:{progress:p.Ay.REQ}}}),[t.$m.SUCCESS]:(e,o)=>{let r=o.shopid,s=e.shop;if(o.voucher&&r){let h=e.shop[r],c=(h?.vouchers||[]).map(e=>e.voucher_code===o.voucher_code?{...e,is_claimed_before:!0}:e);s={...s,[r]:{...h,vouchers:[...c]}}}return{...e,shop:{...s},claimProgress:{...e.claimProgress,[o.voucher_code]:{progress:o.voucher?p.Ay.OK:p.Ay.ERR}}}},[t.$m.FAILED]:(e,o)=>{let{error:r,error_msg:s,error_config:h,voucher_code:c,invalid_message_code:u}=o;return{...e,claimProgress:{...e.claimProgress,[c]:{progress:r===a.Aq?p.Ay.OK:p.Ay.ERR,error:r,error_msg:s,error_config:h,invalid_message_code:u}}}},[t.$k]:(e,o)=>{let{voucher:r,shop_name:s,shop_type:h}=o,{shop_id:c}=r;return c?{...e,recommendedShopVouchers:{...e.recommendedShopVouchers,[c]:e.recommendedShopVouchers[c]?[r,...e.recommendedShopVouchers[c].filter(e=>e.voucher_code!==r.voucher_code)]:[r],shopData:{...e.recommendedShopVouchers.shopData,...e.recommendedShopVouchers.shopData?.[c]?{[c]:{...e.recommendedShopVouchers.shopData[c],vouchers:[r,...e.recommendedShopVouchers.shopData[c].vouchers.filter(e=>e.voucher_code!==r.voucher_code)]}}:{[c]:{vouchers:[r],shopName:s??"",shopType:h??d.l.NORMAL}}}}}:e},[t.S_]:(e,o)=>{let{voucher:r}=o,{shop_id:s}=r;return s?{...e,recommendedShopVouchers:{...e.recommendedShopVouchers,[s]:e.recommendedShopVouchers[s]?e.recommendedShopVouchers[s].filter(e=>e.voucher_code!==r.voucher_code):[],shopData:{...e.recommendedShopVouchers.shopData,...e.recommendedShopVouchers.shopData?.[s]&&{[s]:{...e.recommendedShopVouchers.shopData[s],vouchers:e.recommendedShopVouchers.shopData[s].vouchers.filter(e=>e.voucher_code!==r.voucher_code)}}}}}:e},[t.VZ]:(e,o)=>{let{voucher:r}=o,{shop_id:s}=r;return s?{...e,recommendedShopVouchers:{...e.recommendedShopVouchers,[s]:e.recommendedShopVouchers[s]?e.recommendedShopVouchers[s].map(e=>e.voucher_code===r.voucher_code?r:e):[r],shopData:{...e.recommendedShopVouchers.shopData,...e.recommendedShopVouchers.shopData?.[s]&&{[s]:{...e.recommendedShopVouchers.shopData[s],vouchers:e.recommendedShopVouchers.shopData[s].vouchers.map(e=>e.voucher_code===r.voucher_code?r:e)}}}}}:e},[t.Ub]:(e,o)=>{let{voucher:{voucher_code:r}}=o;return r?{...e,claimProgress:{...e.claimProgress,[r]:{progress:p.Ay.OK}}}:e},[t.bZ.SUCCESS]:(e,o)=>{let r={};return o.data.forEach(o=>{var s;let h=e.shop[o.shopid];r[o.shopid]={error:0,vouchers:(s=h?.vouchers,o.voucher_list.map(e=>({...e,is_claimed_before:s?.some(o=>o.voucher_promotionid===e.voucher_promotionid&&o.is_claimed_before)})))}}),{...e,shop:{...e.shop,...r}}},[t.hq.REQUESTED]:(e,o)=>{let{promotionid:r,voucher_code:s}=o;return{...e,voucherDetail:{[s||"0"]:{[r]:{progress:p.Ay.REQ}}}}},[t.hq.SUCCESS]:(e,o)=>{let{data:r,promotionid:s,voucher_code:h}=o;return{...e,voucherDetail:{[h||"0"]:{...e.voucherDetail[h],[s]:{...r,progress:p.Ay.OK,error:void 0,error_msg:void 0}}}}},[t.hq.FAILED]:(e,o)=>{let{error:r,promotionid:s,voucher_code:h,error_msg:c}=o;return{...e,voucherDetail:{[h||"0"]:{...e.voucherDetail[h],[s]:{error:r,progress:p.Ay.ERR,error_msg:c}}},error:r||-1}}},{shop:{},claimProgress:{},voucherDetail:{},recommendedShopVouchers:{}});var v=r(8394);function _(e){function o(o){let{injectAsyncReducer:r,...h}=o;return c().useEffect(()=>{r({voucher:l})},[r]),(0,s.jsx)(e,{...h})}return o.displayName=`withVoucherReduxInjected(${e.displayName||e.name||"Component"})`,(0,v.withInjectReducer)(o)}}}]);
//# sourceMappingURL=https://sourcemap.webfe.shopeemobile.com/mobilemall-voucher/_/76.0e9b48721a7a052d0019.2023.js.map